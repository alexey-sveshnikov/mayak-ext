(()=>{"use strict";var e,t={957:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=i(n(294)),c=a(n(677)),l=n(235);t.default=function(){const[e,t]=(0,u.useState)(!1),[n,r]=(0,u.useState)(""),o=(0,u.useRef)(null);(0,u.useEffect)((()=>{const n=n=>{"k"!=n.key&&"к"!=n.key||!n.ctrlKey||t(!e)};return document.addEventListener("keyup",n),()=>{document.removeEventListener("keyup",n)}}),[e]);const i=(0,u.useCallback)((()=>{const e=function(e){if(null==e.current)return[];const t=document.evaluate(".//a",e.current,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE);let n=t.iterateNext();const r=[];for(;null!==n;){if(n instanceof HTMLElement){const e=n.getAttribute("href");e&&r.push(e)}n=t.iterateNext()}const o=r.join("\n")+e.current.textContent,i=[],a=new Set;for(const e of o.matchAll(/https:\/\/www\.utkonos\.ru\/item\/(\d+)/g)){const t=e[1];a.has(t)||(a.add(t),i.push({id:parseInt(t),quantity:1}))}return i}(o);0!=e.length&&(console.log("adding items",e),(0,l.saveCartItems)(e).then((()=>{rrToUtkAdapter.modifyItemAtCart(e[0])})))}),[]);return u.default.createElement(u.default.StrictMode,null,e&&u.default.createElement(s,null,u.default.createElement(d,{contentEditable:!0,ref:o},n),u.default.createElement("button",{onClick:i},"Добавить")),u.default.createElement(f,null))};const s=c.default.div`
  position: fixed;
  width: 400px;
  height: 80vh;
  top: calc(50% - 40vh);
  right: calc(50% - 150px);
  background: #ffd9d9;
  z-index: 1000;
  border: 1px solid #555;
  border-radius: 7px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
`,d=c.default.div`
  height: 100%;
  width: 100%;
  border-radius: 7px;
  background: white;
  overflow: scroll;
`,f=c.default.div`
  position: fixed;
  height: 73px;
  width: 36px;
  top: 0;
  right: 0;
  z-index: 1000;
  background: url(https://mayak.help/wp-content/themes/mayak/img/logo.png);
  transform: scale(0.5);
  -webkit-transform-origin-x: right;
  -webkit-transform-origin-y: top;
`},311:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(294)),i=r(n(935)),a=r(n(957));console.log("[utkonos-ext] initializing");const u=document.createElement("div");document.body.appendChild(u),i.default.render(o.default.createElement(a.default,null),u)},235:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.saveCartItems=void 0;const u=i(n(351));t.saveCartItems=function(e){return a(this,void 0,void 0,(function*(){const t=JSON.parse(localStorage.getItem("device_data")||"{}"),n=yield u.get("Utk_SessionToken"),r=[],o=[];for(const t of e)r.push(t.id.toString()),o.push(t.quantity);const i={Head:{DeviceId:t.device_id,Domain:"www.utkonos.ru",RequestId:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))).replaceAll(/-/g,""),MarketingPartnerKey:"mp-cc3c743ffd17487a9021d11129548218",Version:"utkonos-ext",Client:"utkonos-ext",Method:"cartItemMultiAdd",Store:"utk",SessionToken:n},Body:{GoodsItemId:r,Count:o,UseDelta:0,Return:{Cart:"0",CartItemList:"0",TotalCost:"0"}}};console.log("sending request",i);const a=new FormData;a.append("request",JSON.stringify(i));const c=yield fetch("https://www.utkonos.ru/api/v1/cartItemMultiAdd",{headers:{accept:"application/json, text/plain, */*","accept-language":"en-US,en;q=0.9,ru;q=0.8","cache-control":"no-cache",pragma:"no-cache","sec-ch-ua":'"Chromium";v="106", "Google Chrome";v="106", "Not;A=Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://www.utkonos.ru/",referrerPolicy:"no-referrer-when-downgrade",body:a,method:"POST",mode:"cors",credentials:"include"});console.log(c)}))}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,o,i)=>{if(!n){var a=1/0;for(s=0;s<e.length;s++){for(var[n,o,i]=e[s],u=!0,c=0;c<n.length;c++)(!1&i||a>=i)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(u=!1,i<a&&(a=i));if(u){e.splice(s--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var s=e.length;s>0&&e[s-1][2]>i;s--)e[s]=e[s-1];e[s]=[n,o,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=575,(()=>{var e={575:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[a,u,c]=n,l=0;if(a.some((t=>0!==e[t]))){for(o in u)r.o(u,o)&&(r.m[o]=u[o]);if(c)var s=c(r)}for(t&&t(n);l<a.length;l++)i=a[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(s)},n=self.webpackChunkutkonos_ext=self.webpackChunkutkonos_ext||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0;var o=r.O(void 0,[736],(()=>r(311)));o=r.O(o)})();